{"ast":null,"code":"import _slicedToArray from\"/Users/laptop/Desktop/programming/nodechat/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{io}from\"socket.io-client\";import Cookies from\"js-cookie\";import axios from\"axios\";import{useDispatch,useSelector}from\"react-redux\";import{userData,showMessages,chatData,openChat,markTypingStop}from\"../redux/actions\";import moment from\"moment\";import ProfileImg from\"./ProfileImg\";import{Icon,InlineIcon}from\"@iconify/react\";import more2Fill from\"@iconify-icons/ri/more-2-fill\";import checkboxCircle from\"@iconify-icons/ri/checkbox-circle-line\";import forbidLine from\"@iconify-icons/ri/forbid-line\";import closeCircle from\"@iconify-icons/ri/close-circle-line\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function RecentConversation(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),friendRequests=_useState2[0],setFriendRequests=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),friendRequestsDropDown=_useState4[0],setFriendRequestsDropDown=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),openChats=_useState6[0],setOpenChats=_useState6[1];var getTypingUsers=useSelector(function(state){return state.typingUsers;});var allFriends=useSelector(function(state){return state.friends;});var typingUsers=useSelector(function(state){return state.typingUsers;});var chatDataState=useSelector(function(state){return state.chatData;});var dispatch=useDispatch();var openConversation=function openConversation(userId){dispatch(openChat(true));axios.get(\"http://localhost:8000/chats?userId=\"+userId).then(function(response){// handle success\ndispatch(showMessages(response.data.info.messages));dispatch(chatData(response.data.info));}).catch(function(error){// handle error\nconsole.log(error);});};console.log(typingUsers.typingUsers);useEffect(function(){setTimeout(function(){dispatch(markTypingStop(typingUsers.typingUsers[typingUsers.typingUsers.length-1]));},4000);},[typingUsers]);var openFriendRequestsDropDown=function openFriendRequestsDropDown(){setFriendRequestsDropDown(true);};var closeFriendRequestsDropDown=function closeFriendRequestsDropDown(){setFriendRequestsDropDown(false);};useEffect(function(){axios.defaults.withCredentials=true;axios.get(\"http://localhost:8000/friendRequests\",{withCredentals:true}).then(function(res){setFriendRequests(res.data.info);}).catch(function(e){return console.log(e);});},[]);var acceptFriend=function acceptFriend(id){axios.defaults.withCredentials=true;axios.get(\"http://localhost:8000/acceptFriend?id=\"+id,{withCredentals:true}).then(function(res){console.log(res);}).catch(function(e){return console.log(e);});};var filteredFriends=allFriends.friends.filter(function(res){return res.messages.length>0;});var friendList=filteredFriends.map(function(res,key){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"a\",{onClick:function onClick(){return openConversation(res.friendUserId);},children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat-user-img online align-self-center me-3 ms-0\",children:[/*#__PURE__*/_jsx(ProfileImg,{src:res.friendInfo.profileImg,class:\"rounded-circle avatar-xs\"}),/*#__PURE__*/_jsx(\"span\",{className:\"user-status\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 overflow-hidden\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"text-truncate font-size-15 mb-1\",children:res.friendName}),/*#__PURE__*/_jsx(\"p\",{className:\"chat-user-message text-truncate mb-0\",children:getTypingUsers.typingUsers.includes(res.friendInfo.id)?/*#__PURE__*/_jsxs(\"p\",{className:\"chat-user-message text-truncate mb-0\",style:{color:\"#7269ef\",fontWeight:\"500\"},children:[\"typing\",/*#__PURE__*/_jsxs(\"span\",{className:\"animate-typing\",style:{marginLeft:\"3px\"},children:[/*#__PURE__*/_jsx(\"span\",{className:\"dot\",style:{backgroundColor:\"#7269ef\",marginRight:\"2px\"}}),/*#__PURE__*/_jsx(\"span\",{className:\"dot\",style:{backgroundColor:\"#7269ef\",marginRight:\"2px\"}}),/*#__PURE__*/_jsx(\"span\",{className:\"dot\",style:{backgroundColor:\"#7269ef\",marginRight:\"2px\"}})]})]}):res.messages[res.messages.length-1].message})]}),/*#__PURE__*/_jsx(\"div\",{className:\"font-size-11\",children:moment(res.messages[res.messages.length-1].createdAt).fromNow()})]})})},key);});var requests=friendRequests.length>0?friendRequests.map(function(res,key){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"a\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat-user-img online align-self-center me-3 ms-0\",children:[/*#__PURE__*/_jsx(\"img\",{src:res.inviter.profileImg,className:\"rounded-circle avatar-xs\",alt:\"\"}),/*#__PURE__*/_jsx(\"span\",{className:\"user-status\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 overflow-hidden\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"text-truncate font-size-15 mb-1\",children:res.inviter.name}),/*#__PURE__*/_jsx(\"p\",{className:\"chat-user-message text-truncate mb-0\",children:\"hello world\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"font-size-11 d-flex align-items-center\",children:moment(res.inviter.createdAt).startOf(\"hour\").fromNow()}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown\",children:[/*#__PURE__*/_jsx(\"a\",{className:\"text-muted dropdown-toggle\",\"data-bs-toggle\":\"dropdown\",\"aria-haspopup\":\"true\",\"aria-expanded\":\"false\",onClick:openFriendRequestsDropDown,children:/*#__PURE__*/_jsx(Icon,{icon:more2Fill})}),friendRequestsDropDown?/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown-menu dropdown-menu-end d-block\",children:[/*#__PURE__*/_jsxs(\"a\",{className:\"dropdown-item\",href:\"#\",onClick:acceptFriend(res.id),children:[\"Accept\",\" \",/*#__PURE__*/_jsx(Icon,{icon:checkboxCircle,className:\" float-end text-muted\"})]}),/*#__PURE__*/_jsxs(\"a\",{className:\"dropdown-item\",href:\"#\",children:[\"Reject\",\" \",/*#__PURE__*/_jsx(Icon,{icon:closeCircle,className:\" float-end text-muted\"})]}),/*#__PURE__*/_jsxs(\"a\",{className:\"dropdown-item\",href:\"#\",children:[\"Block\",\" \",/*#__PURE__*/_jsx(Icon,{icon:forbidLine,className:\" float-end text-muted\"})]})]}):false]})})]})})},key);}):false;return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"px-4 pt-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"mb-4\",children:\"Chats\"}),/*#__PURE__*/_jsx(\"div\",{className:\"search-box chat-search-box\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3 rounded-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text text-muted bg-light pe-1 ps-3\",id:\"basic-addon1\",children:/*#__PURE__*/_jsx(\"i\",{className:\"ri-search-line search-icon font-size-18\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control bg-light\",placeholder:\"Search messages or users\",\"aria-label\":\"Search messages or users\",\"aria-describedby\":\"basic-addon1\"})]})}),\" \"]}),\" \",/*#__PURE__*/_jsx(\"ul\",{className:\"list-unstyled chat-list chat-user-list\",children:requests}),/*#__PURE__*/_jsxs(\"div\",{className:\"px-2\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"mb-3 px-3 font-size-16\",children:\"Recent\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-message-list\",\"data-simplebar\":\"init\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"simplebar-wrapper\",style:{margin:\"0px\"},children:[/*#__PURE__*/_jsx(\"div\",{className:\"simplebar-height-auto-observer-wrapper\",children:/*#__PURE__*/_jsx(\"div\",{className:\"simplebar-height-auto-observer\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"simplebar-mask\",children:/*#__PURE__*/_jsx(\"div\",{className:\"simplebar-offset\",style:{right:\"-20px\",bottom:\"0px\"},children:/*#__PURE__*/_jsx(\"div\",{className:\"simplebar-content-wrapper\",style:{height:\"100%\",paddingRight:\"20px\",paddingBottom:\"0px\",overflow:\"hidden scroll\"},children:/*#__PURE__*/_jsx(\"div\",{className:\"simplebar-content\",style:{padding:\"0px\"},children:/*#__PURE__*/_jsx(\"ul\",{className:\"list-unstyled chat-list chat-user-list\",children:friendList.length>0?friendList:/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center\",children:\"No recent chat\"}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center mt-3\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",class:\"btn btn-primary font-size-16 btn-lg chat-send waves-effect waves-light\",children:\"Start conversation\"})})]})})})})})}),/*#__PURE__*/_jsx(\"div\",{className:\"simplebar-placeholder\",style:{width:\"auto\",height:\"890px\"}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"simplebar-track simplebar-horizontal\",style:{visibility:\"hidden\"},children:/*#__PURE__*/_jsx(\"div\",{className:\"simplebar-scrollbar\",style:{transform:\"translate3d(0px, 0px, 0px)\",display:\"none\"}})}),/*#__PURE__*/_jsx(\"div\",{className:\"simplebar-track simplebar-vertical\",style:{visibility:\"visible\"},children:/*#__PURE__*/_jsx(\"div\",{className:\"simplebar-scrollbar\",style:{height:\"597px\",transform:\"translate3d(0px, 0px, 0px)\",display:\"block\"}})})]})]})]})});}","map":{"version":3,"sources":["/Users/laptop/Desktop/programming/nodechat/client/src/component/RecentConversation.js"],"names":["React","useState","useEffect","io","Cookies","axios","useDispatch","useSelector","userData","showMessages","chatData","openChat","markTypingStop","moment","ProfileImg","Icon","InlineIcon","more2Fill","checkboxCircle","forbidLine","closeCircle","RecentConversation","props","friendRequests","setFriendRequests","friendRequestsDropDown","setFriendRequestsDropDown","openChats","setOpenChats","getTypingUsers","state","typingUsers","allFriends","friends","chatDataState","dispatch","openConversation","userId","get","then","response","data","info","messages","catch","error","console","log","setTimeout","length","openFriendRequestsDropDown","closeFriendRequestsDropDown","defaults","withCredentials","withCredentals","res","e","acceptFriend","id","filteredFriends","filter","friendList","map","key","friendUserId","friendInfo","profileImg","friendName","includes","color","fontWeight","marginLeft","backgroundColor","marginRight","message","createdAt","fromNow","requests","inviter","name","startOf","margin","right","bottom","height","paddingRight","paddingBottom","overflow","padding","width","visibility","transform","display"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { io } from \"socket.io-client\";\nimport Cookies from \"js-cookie\";\nimport axios from \"axios\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport {\n  userData,\n  showMessages,\n  chatData,\n  openChat,\n  markTypingStop,\n} from \"../redux/actions\";\nimport moment from \"moment\";\nimport ProfileImg from \"./ProfileImg\";\nimport { Icon, InlineIcon } from \"@iconify/react\";\nimport more2Fill from \"@iconify-icons/ri/more-2-fill\";\nimport checkboxCircle from \"@iconify-icons/ri/checkbox-circle-line\";\nimport forbidLine from \"@iconify-icons/ri/forbid-line\";\nimport closeCircle from \"@iconify-icons/ri/close-circle-line\";\n\nexport default function RecentConversation(props) {\n  const [friendRequests, setFriendRequests] = useState([]);\n  const [friendRequestsDropDown, setFriendRequestsDropDown] = useState(false);\n  const [openChats, setOpenChats] = useState(false);\n  const getTypingUsers = useSelector((state) => state.typingUsers);\n  const allFriends = useSelector((state) => state.friends);\n  const typingUsers = useSelector((state) => state.typingUsers);\n  const chatDataState = useSelector((state) => state.chatData);\n\n  const dispatch = useDispatch();\n\n  const openConversation = (userId) => {\n    dispatch(openChat(true));\n    axios\n      .get(\"http://localhost:8000/chats?userId=\" + userId)\n      .then(function (response) {\n        // handle success\n        dispatch(showMessages(response.data.info.messages));\n        dispatch(chatData(response.data.info));\n      })\n      .catch(function (error) {\n        // handle error\n        console.log(error);\n      });\n  };\n  console.log(typingUsers.typingUsers);\n  useEffect(() => {\n    setTimeout(() => {\n      dispatch(\n        markTypingStop(\n          typingUsers.typingUsers[typingUsers.typingUsers.length - 1]\n        )\n      );\n    }, 4000);\n  }, [typingUsers]);\n\n  const openFriendRequestsDropDown = () => {\n    setFriendRequestsDropDown(true);\n  };\n\n  const closeFriendRequestsDropDown = () => {\n    setFriendRequestsDropDown(false);\n  };\n\n  useEffect(() => {\n    axios.defaults.withCredentials = true;\n    axios\n      .get(\"http://localhost:8000/friendRequests\", {\n        withCredentals: true,\n      })\n      .then((res) => {\n        setFriendRequests(res.data.info);\n      })\n      .catch((e) => console.log(e));\n  }, []);\n\n  const acceptFriend = (id) => {\n    axios.defaults.withCredentials = true;\n    axios\n      .get(\"http://localhost:8000/acceptFriend?id=\" + id, {\n        withCredentals: true,\n      })\n      .then((res) => {\n        console.log(res);\n      })\n      .catch((e) => console.log(e));\n  };\n\n  const filteredFriends = allFriends.friends.filter(\n    (res) => res.messages.length > 0\n  );\n  const friendList = filteredFriends.map((res, key) => (\n    <li key={key}>\n      <a onClick={() => openConversation(res.friendUserId)}>\n        <div className=\"d-flex\">\n          <div className=\"chat-user-img online align-self-center me-3 ms-0\">\n            <ProfileImg\n              src={res.friendInfo.profileImg}\n              class={\"rounded-circle avatar-xs\"}\n            />\n            <span className=\"user-status\" />\n          </div>\n          <div className=\"flex-1 overflow-hidden\">\n            <h5 className=\"text-truncate font-size-15 mb-1\">\n              {res.friendName}\n            </h5>\n            <p className=\"chat-user-message text-truncate mb-0\">\n              {getTypingUsers.typingUsers.includes(res.friendInfo.id) ? (\n                <p\n                  className=\"chat-user-message text-truncate mb-0\"\n                  style={{ color: \"#7269ef\", fontWeight: \"500\" }}\n                >\n                  typing\n                  <span\n                    className=\"animate-typing\"\n                    style={{ marginLeft: \"3px\" }}\n                  >\n                    <span\n                      className=\"dot\"\n                      style={{ backgroundColor: \"#7269ef\", marginRight: \"2px\" }}\n                    ></span>\n                    <span\n                      className=\"dot\"\n                      style={{ backgroundColor: \"#7269ef\", marginRight: \"2px\" }}\n                    ></span>\n                    <span\n                      className=\"dot\"\n                      style={{ backgroundColor: \"#7269ef\", marginRight: \"2px\" }}\n                    ></span>\n                  </span>\n                </p>\n              ) : (\n                res.messages[res.messages.length - 1].message\n              )}\n            </p>\n          </div>\n          <div className=\"font-size-11\">\n            {moment(res.messages[res.messages.length - 1].createdAt).fromNow()}\n          </div>\n        </div>\n      </a>\n    </li>\n  ));\n  const requests =\n    friendRequests.length > 0\n      ? friendRequests.map((res, key) => {\n          return (\n            <li key={key}>\n              <a>\n                <div className=\"d-flex\">\n                  <div className=\"chat-user-img online align-self-center me-3 ms-0\">\n                    <img\n                      src={res.inviter.profileImg}\n                      className=\"rounded-circle avatar-xs\"\n                      alt=\"\"\n                    />\n                    <span className=\"user-status\" />\n                  </div>\n                  <div className=\"flex-1 overflow-hidden\">\n                    <h5 className=\"text-truncate font-size-15 mb-1\">\n                      {res.inviter.name}\n                    </h5>\n                    <p className=\"chat-user-message text-truncate mb-0\">\n                      hello world\n                    </p>\n                  </div>\n                  <div className=\"font-size-11 d-flex align-items-center\">\n                    {moment(res.inviter.createdAt).startOf(\"hour\").fromNow()}\n                  </div>\n                  <div>\n                    <div className=\"dropdown\">\n                      <a\n                        className=\"text-muted dropdown-toggle\"\n                        data-bs-toggle=\"dropdown\"\n                        aria-haspopup=\"true\"\n                        aria-expanded=\"false\"\n                        onClick={openFriendRequestsDropDown}\n                      >\n                        <Icon icon={more2Fill} />\n                      </a>\n                      {friendRequestsDropDown ? (\n                        <div className=\"dropdown-menu dropdown-menu-end d-block\">\n                          <a\n                            className=\"dropdown-item\"\n                            href=\"#\"\n                            onClick={acceptFriend(res.id)}\n                          >\n                            Accept{\" \"}\n                            <Icon\n                              icon={checkboxCircle}\n                              className=\" float-end text-muted\"\n                            />\n                          </a>\n                          <a className=\"dropdown-item\" href=\"#\">\n                            Reject{\" \"}\n                            <Icon\n                              icon={closeCircle}\n                              className=\" float-end text-muted\"\n                            />\n                          </a>\n                          <a className=\"dropdown-item\" href=\"#\">\n                            Block{\" \"}\n                            <Icon\n                              icon={forbidLine}\n                              className=\" float-end text-muted\"\n                            />\n                          </a>\n                        </div>\n                      ) : (\n                        false\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </a>\n            </li>\n          );\n        })\n      : false;\n\n  return (\n    <>\n      {/* Start chats content */}\n      <div>\n        <div className=\"px-4 pt-4\">\n          <h4 className=\"mb-4\">Chats</h4>\n          <div className=\"search-box chat-search-box\">\n            <div className=\"input-group mb-3 rounded-3\">\n              <span\n                className=\"input-group-text text-muted bg-light pe-1 ps-3\"\n                id=\"basic-addon1\"\n              >\n                <i className=\"ri-search-line search-icon font-size-18\" />\n              </span>\n              <input\n                type=\"text\"\n                className=\"form-control bg-light\"\n                placeholder=\"Search messages or users\"\n                aria-label=\"Search messages or users\"\n                aria-describedby=\"basic-addon1\"\n              />\n            </div>\n          </div>{\" \"}\n          {/* Search Box*/}\n        </div>{\" \"}\n        {/* .p-4 */}\n        {/* Start chat-message-list */}\n        <ul className=\"list-unstyled chat-list chat-user-list\">{requests}</ul>\n        <div className=\"px-2\">\n          <h5 className=\"mb-3 px-3 font-size-16\">Recent</h5>\n          <div className=\"chat-message-list\" data-simplebar=\"init\">\n            <div className=\"simplebar-wrapper\" style={{ margin: \"0px\" }}>\n              <div className=\"simplebar-height-auto-observer-wrapper\">\n                <div className=\"simplebar-height-auto-observer\" />\n              </div>\n              <div className=\"simplebar-mask\">\n                <div\n                  className=\"simplebar-offset\"\n                  style={{ right: \"-20px\", bottom: \"0px\" }}\n                >\n                  <div\n                    className=\"simplebar-content-wrapper\"\n                    style={{\n                      height: \"100%\",\n                      paddingRight: \"20px\",\n                      paddingBottom: \"0px\",\n                      overflow: \"hidden scroll\",\n                    }}\n                  >\n                    <div\n                      className=\"simplebar-content\"\n                      style={{ padding: \"0px\" }}\n                    >\n                      <ul className=\"list-unstyled chat-list chat-user-list\">\n                        {friendList.length > 0 ? (\n                          friendList\n                        ) : (\n                          <li>\n                            <div className=\"d-flex justify-content-center\">\n                              No recent chat\n                            </div>\n                            <div className=\"d-flex justify-content-center mt-3\">\n                              <button\n                                type=\"submit\"\n                                class=\"btn btn-primary font-size-16 btn-lg chat-send waves-effect waves-light\"\n                              >\n                                Start conversation\n                              </button>\n                            </div>\n                          </li>\n                        )}\n                      </ul>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div\n                className=\"simplebar-placeholder\"\n                style={{ width: \"auto\", height: \"890px\" }}\n              />\n            </div>\n            <div\n              className=\"simplebar-track simplebar-horizontal\"\n              style={{ visibility: \"hidden\" }}\n            >\n              <div\n                className=\"simplebar-scrollbar\"\n                style={{\n                  transform: \"translate3d(0px, 0px, 0px)\",\n                  display: \"none\",\n                }}\n              />\n            </div>\n            <div\n              className=\"simplebar-track simplebar-vertical\"\n              style={{ visibility: \"visible\" }}\n            >\n              <div\n                className=\"simplebar-scrollbar\"\n                style={{\n                  height: \"597px\",\n                  transform: \"translate3d(0px, 0px, 0px)\",\n                  display: \"block\",\n                }}\n              />\n            </div>\n          </div>\n        </div>\n        {/* End chat-message-list */}\n      </div>\n      {/* Start chats content */}\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}